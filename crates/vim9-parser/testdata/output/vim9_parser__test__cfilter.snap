---
source: crates/vim9-parser/src/lib.rs
assertion_line: 2836
expression: snapshot_parsing(contents)
---
[
    Vim9Script(
        Vim9ScriptCommand {
            noclear: false,
            eol: Token(EndOfLine, (0,10)->(0,10)),
        },
    ),
    NoOp(
        Token(EndOfLine, "\n", (1,0)->(1,0)),
    ),
    Comment(
        Token(Comment, "# cfilter.vim: Plugin to filter entries from a quickfix/location list", (2,0)->(2,69)),
    ),
    Comment(
        Token(Comment, "# Last Change: Jun 30, 2022", (3,0)->(3,27)),
    ),
    Comment(
        Token(Comment, "# Maintainer: Yegappan Lakshmanan (yegappan AT yahoo DOT com)", (4,0)->(4,61)),
    ),
    Comment(
        Token(Comment, "# Version: 2.0", (5,0)->(5,14)),
    ),
    Comment(
        Token(Comment, "#", (6,0)->(6,1)),
    ),
    Comment(
        Token(Comment, "# Commands to filter the quickfix list:", (7,0)->(7,39)),
    ),
    Comment(
        Token(Comment, "#   :Cfilter[!] /{pat}/", (8,0)->(8,23)),
    ),
    Comment(
        Token(Comment, "#       Create a new quickfix list from entries matching {pat} in the current", (9,0)->(9,77)),
    ),
    Comment(
        Token(Comment, "#       quickfix list. Both the file name and the text of the entries are", (10,0)->(10,73)),
    ),
    Comment(
        Token(Comment, "#       matched against {pat}. If ! is supplied, then entries not matching", (11,0)->(11,74)),
    ),
    Comment(
        Token(Comment, "#       {pat} are used. The pattern can be optionally enclosed using one of", (12,0)->(12,75)),
    ),
    Comment(
        Token(Comment, "#       the following characters: ', \", /. If the pattern is empty, then the", (13,0)->(13,76)),
    ),
    Comment(
        Token(Comment, "#       last used search pattern is used.", (14,0)->(14,41)),
    ),
    Comment(
        Token(Comment, "#   :Lfilter[!] /{pat}/", (15,0)->(15,23)),
    ),
    Comment(
        Token(Comment, "#       Same as :Cfilter but operates on the current location list.", (16,0)->(16,67)),
    ),
    Comment(
        Token(Comment, "#", (17,0)->(17,1)),
    ),
    NoOp(
        Token(EndOfLine, "\n", (18,0)->(18,0)),
    ),
    Def(
        DefCommand {
            def: Token(Identifier, (19,0)->(19,3)),
            name: Raw(Qf_filter),
            args: Signature {
                open: Token(LeftParen, (19,13)->(19,14)),
                params: [
                    Parameter {
                        name: Raw(qf),
                        ty: Some(
                            BoolOrNumber,
                        ),
                        equal: None,
                        default_val: None,
                    },
                    Parameter {
                        name: Raw(searchpat),
                        ty: Some(
                            String,
                        ),
                        equal: None,
                        default_val: None,
                    },
                    Parameter {
                        name: Raw(bang),
                        ty: Some(
                            String,
                        ),
                        equal: None,
                        default_val: None,
                    },
                ],
                close: Token(RightParen, (19,55)->(19,56)),
            },
            ret: None,
            def_eol: Token(EndOfLine, (19,56)->(19,56)),
            body: Body {
                commands: [
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (20,2)->(20,5)),
                            name: Raw(Xgetlist),
                            ty: Some(
                                Func(
                                    Naked,
                                ),
                            ),
                            eol: Token(EndOfLine, (20,20)->(20,20)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (21,2)->(21,5)),
                            name: Raw(Xsetlist),
                            ty: Some(
                                Func(
                                    Naked,
                                ),
                            ),
                            eol: Token(EndOfLine, (21,20)->(21,20)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (22,2)->(22,5)),
                            name: Raw(cmd),
                            ty: Some(
                                String,
                            ),
                            eol: Token(EndOfLine, (22,17)->(22,17)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (23,2)->(23,5)),
                            name: Raw(firstchar),
                            ty: Some(
                                String,
                            ),
                            eol: Token(EndOfLine, (23,23)->(23,23)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (24,2)->(24,5)),
                            name: Raw(lastchar),
                            ty: Some(
                                String,
                            ),
                            eol: Token(EndOfLine, (24,22)->(24,22)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (25,2)->(25,5)),
                            name: Raw(pat),
                            ty: Some(
                                String,
                            ),
                            eol: Token(EndOfLine, (25,17)->(25,17)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (26,2)->(26,5)),
                            name: Raw(title),
                            ty: Some(
                                String,
                            ),
                            eol: Token(EndOfLine, (26,19)->(26,19)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (27,2)->(27,5)),
                            name: Raw(Cond),
                            ty: Some(
                                Func(
                                    Naked,
                                ),
                            ),
                            eol: Token(EndOfLine, (27,16)->(27,16)),
                        },
                    ),
                    Decl(
                        DeclCommand {
                            var: Token(Identifier, (28,2)->(28,5)),
                            name: Raw(items),
                            ty: Some(
                                List {
                                    open: Token(AngleLeft, (28,17)->(28,18)),
                                    inner: Any,
                                    close: Token(GreaterThan, (28,21)->(28,22)),
                                },
                            ),
                            eol: Token(EndOfLine, (28,22)->(28,22)),
                        },
                    ),
                    NoOp(
                        Token(EndOfLine, "\n", (29,0)->(29,0)),
                    ),
                    If(
                        IfCommand {
                            if_tok: Token(Identifier, (30,2)->(30,4)),
                            condition: Identifier(
                                Raw(qf),
                            ),
                            if_eol: Token(EndOfLine, (30,7)->(30,7)),
                            body: Body {
                                commands: [
                                    Statement(
                                        Assign(
                                            AssignStatement {
                                                left: Identifier(
                                                    Raw(Xgetlist),
                                                ),
                                                equals: Token(Equal, (31,13)->(31,14)),
                                                right: Call(
                                                    f: Identifier(Raw(function)) arg: [
                                                        String(
                                                            SingleQuote(
                                                                "getqflist",
                                                            ),
                                                        ),
                                                    ],
                                                ),
                                                eol: Token(EndOfLine, (31,36)->(31,36)),
                                            },
                                        ),
                                    ),
                                    Statement(
                                        Assign(
                                            AssignStatement {
                                                left: Identifier(
                                                    Raw(Xsetlist),
                                                ),
                                                equals: Token(Equal, (32,13)->(32,14)),
                                                right: Call(
                                                    f: Identifier(Raw(function)) arg: [
                                                        String(
                                                            SingleQuote(
                                                                "setqflist",
                                                            ),
                                                        ),
                                                    ],
                                                ),
                                                eol: Token(EndOfLine, (32,36)->(32,36)),
                                            },
                                        ),
                                    ),
                                    Statement(
                                        Assign(
                                            AssignStatement {
                                                left: Identifier(
                                                    Raw(cmd),
                                                ),
                                                equals: Token(Equal, (33,8)->(33,9)),
                                                right: Infix(
                                                    InfixExpression {
                                                        token: Token(StringConcat, "..", (33,21)->(33,23)),
                                                        operator: StringConcat,
                                                        left: String(
                                                            SingleQuote(
                                                                ":Cfilter",
                                                            ),
                                                        ),
                                                        right: Identifier(
                                                            Raw(bang),
                                                        ),
                                                    },
                                                ),
                                                eol: Token(EndOfLine, (33,28)->(33,28)),
                                            },
                                        ),
                                    ),
                                ],
                            },
                            elseifs: [],
                            else_command: Some(
                                ElseCommand {
                                    else_tok: Token(Identifier, (34,2)->(34,6)),
                                    else_eol: Token(EndOfLine, (34,6)->(34,6)),
                                    body: Body {
                                        commands: [
                                            Statement(
                                                Assign(
                                                    AssignStatement {
                                                        left: Identifier(
                                                            Raw(Xgetlist),
                                                        ),
                                                        equals: Token(Equal, (35,13)->(35,14)),
                                                        right: Call(
                                                            f: Identifier(Raw(function)) arg: [
                                                                String(
                                                                    SingleQuote(
                                                                        "getloclist",
                                                                    ),
                                                                ),
                                                                Array(
                                                                    ArrayLiteral {
                                                                        open: Token(LeftBracket, (35,38)->(35,39)),
                                                                        elements: [
                                                                            Number(
                                                                                Number(0),
                                                                            ),
                                                                        ],
                                                                        close: Token(RightBracket, (35,40)->(35,41)),
                                                                    },
                                                                ),
                                                            ],
                                                        ),
                                                        eol: Token(EndOfLine, (35,42)->(35,42)),
                                                    },
                                                ),
                                            ),
                                            Statement(
                                                Assign(
                                                    AssignStatement {
                                                        left: Identifier(
                                                            Raw(Xsetlist),
                                                        ),
                                                        equals: Token(Equal, (36,13)->(36,14)),
                                                        right: Call(
                                                            f: Identifier(Raw(function)) arg: [
                                                                String(
                                                                    SingleQuote(
                                                                        "setloclist",
                                                                    ),
                                                                ),
                                                                Array(
                                                                    ArrayLiteral {
                                                                        open: Token(LeftBracket, (36,38)->(36,39)),
                                                                        elements: [
                                                                            Number(
                                                                                Number(0),
                                                                            ),
                                                                        ],
                                                                        close: Token(RightBracket, (36,40)->(36,41)),
                                                                    },
                                                                ),
                                                            ],
                                                        ),
                                                        eol: Token(EndOfLine, (36,42)->(36,42)),
                                                    },
                                                ),
                                            ),
                                            Statement(
                                                Assign(
                                                    AssignStatement {
                                                        left: Identifier(
                                                            Raw(cmd),
                                                        ),
                                                        equals: Token(Equal, (37,8)->(37,9)),
                                                        right: Infix(
                                                            InfixExpression {
                                                                token: Token(StringConcat, "..", (37,21)->(37,23)),
                                                                operator: StringConcat,
                                                                left: String(
                                                                    SingleQuote(
                                                                        ":Lfilter",
                                                                    ),
                                                                ),
                                                                right: Identifier(
                                                                    Raw(bang),
                                                                ),
                                                            },
                                                        ),
                                                        eol: Token(EndOfLine, (37,28)->(37,28)),
                                                    },
                                                ),
                                            ),
                                        ],
                                    },
                                },
                            ),
                            endif_tok: Token(Identifier, (38,2)->(38,7)),
                            endif_eol: Token(EndOfLine, (38,7)->(38,7)),
                        },
                    ),
                    NoOp(
                        Token(EndOfLine, "\n", (39,0)->(39,0)),
                    ),
                    Statement(
                        Assign(
                            AssignStatement {
                                left: Identifier(
                                    Raw(firstchar),
                                ),
                                equals: Token(Equal, (40,12)->(40,13)),
                                right: Index(
                                    IndexExpression {
                                        container: Identifier(
                                            Raw(searchpat),
                                        ),
                                        open: Token(LeftBracket, (40,23)->(40,24)),
                                        index: Item(
                                            Number(
                                                Number(0),
                                            ),
                                        ),
                                        close: Token(RightBracket, (40,25)->(40,26)),
                                    },
                                ),
                                eol: Token(EndOfLine, (40,26)->(40,26)),
                            },
                        ),
                    ),
                    Statement(
                        Assign(
                            AssignStatement {
                                left: Identifier(
                                    Raw(lastchar),
                                ),
                                equals: Token(Equal, (41,11)->(41,12)),
                                right: Index(
                                    IndexExpression {
                                        container: Identifier(
                                            Raw(searchpat),
                                        ),
                                        open: Token(LeftBracket, (41,22)->(41,23)),
                                        index: Slice(
                                            VimSlice {
                                                start: Some(
                                                    Prefix(
                                                        PrefixExpression {
                                                            token: Token(Minus, (41,23)->(41,24)),
                                                            operator: Minus,
                                                            right: Number(
                                                                Number(1),
                                                            ),
                                                        },
                                                    ),
                                                ),
                                                colon: Token(SpacedColon, (41,26)->(41,27)),
                                                finish: None,
                                            },
                                        ),
                                        close: Token(RightBracket, (41,27)->(41,28)),
                                    },
                                ),
                                eol: Token(EndOfLine, (41,28)->(41,28)),
                            },
                        ),
                    ),
                    If(
                        IfCommand {
                            if_tok: Token(Identifier, (42,2)->(42,4)),
                            condition: Infix(
                                InfixExpression {
                                    token: Token(And, "&&", (42,27)->(42,29)),
                                    operator: And,
                                    left: Infix(
                                        InfixExpression {
                                            token: Token(EqualTo, "==", (42,15)->(42,17)),
                                            operator: EqualTo,
                                            left: Identifier(
                                                Raw(firstchar),
                                            ),
                                            right: Identifier(
                                                Raw(lastchar),
                                            ),
                                        },
                                    ),
                                    right: Grouped(
                                        GroupedExpression {
                                            open: Token(LeftParen, (43,14)->(43,15)),
                                            expr: Infix(
                                                InfixExpression {
                                                    token: Token(Or, "||", (43,52)->(43,54)),
                                                    operator: Or,
                                                    left: Infix(
                                                        InfixExpression {
                                                            token: Token(Or, "||", (43,32)->(43,34)),
                                                            operator: Or,
                                                            left: Infix(
                                                                InfixExpression {
                                                                    token: Token(EqualTo, "==", (43,25)->(43,27)),
                                                                    operator: EqualTo,
                                                                    left: Identifier(
                                                                        Raw(firstchar),
                                                                    ),
                                                                    right: String(
                                                                        SingleQuote(
                                                                            "/",
                                                                        ),
                                                                    ),
                                                                },
                                                            ),
                                                            right: Infix(
                                                                InfixExpression {
                                                                    token: Token(EqualTo, "==", (43,45)->(43,47)),
                                                                    operator: EqualTo,
                                                                    left: Identifier(
                                                                        Raw(firstchar),
                                                                    ),
                                                                    right: String(
                                                                        SingleQuote(
                                                                            "\"",
                                                                        ),
                                                                    ),
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                    right: Infix(
                                                        InfixExpression {
                                                            token: Token(EqualTo, "==", (43,65)->(43,67)),
                                                            operator: EqualTo,
                                                            left: Identifier(
                                                                Raw(firstchar),
                                                            ),
                                                            right: String(
                                                                DoubleQuote(
                                                                    "'",
                                                                ),
                                                            ),
                                                        },
                                                    ),
                                                },
                                            ),
                                            close: Token(RightParen, (43,71)->(43,72)),
                                        },
                                    ),
                                },
                            ),
                            if_eol: Token(EndOfLine, (43,72)->(43,72)),
                            body: Body {
                                commands: [
                                    Statement(
                                        Assign(
                                            AssignStatement {
                                                left: Identifier(
                                                    Raw(pat),
                                                ),
                                                equals: Token(Equal, (44,8)->(44,9)),
                                                right: Index(
                                                    IndexExpression {
                                                        container: Identifier(
                                                            Raw(searchpat),
                                                        ),
                                                        open: Token(LeftBracket, (44,19)->(44,20)),
                                                        index: Slice(
                                                            VimSlice {
                                                                start: Some(
                                                                    Number(
                                                                        Number(1),
                                                                    ),
                                                                ),
                                                                colon: Token(SpacedColon, (44,22)->(44,24)),
                                                                finish: Some(
                                                                    Prefix(
                                                                        PrefixExpression {
                                                                            token: Token(Minus, (44,24)->(44,25)),
                                                                            operator: Minus,
                                                                            right: Number(
                                                                                Number(2),
                                                                            ),
                                                                        },
                                                                    ),
                                                                ),
                                                            },
                                                        ),
                                                        close: Token(RightBracket, (44,26)->(44,27)),
                                                    },
                                                ),
                                                eol: Token(EndOfLine, (44,27)->(44,27)),
                                            },
                                        ),
                                    ),
                                    If(
                                        IfCommand {
                                            if_tok: Token(Identifier, (45,4)->(45,6)),
                                            condition: Infix(
                                                InfixExpression {
                                                    token: Token(EqualTo, "==", (45,11)->(45,13)),
                                                    operator: EqualTo,
                                                    left: Identifier(
                                                        Raw(pat),
                                                    ),
                                                    right: String(
                                                        SingleQuote(
                                                            "",
                                                        ),
                                                    ),
                                                },
                                            ),
                                            if_eol: Token(EndOfLine, (45,16)->(45,16)),
                                            body: Body {
                                                commands: [
                                                    Comment(
                                                        Token(Comment, "# Use the last search pattern", (46,6)->(46,35)),
                                                    ),
                                                    Statement(
                                                        Assign(
                                                            AssignStatement {
                                                                left: Identifier(
                                                                    Raw(pat),
                                                                ),
                                                                equals: Token(Equal, (47,10)->(47,11)),
                                                                right: Register(
                                                                    Register {
                                                                        register: "/",
                                                                    },
                                                                ),
                                                                eol: Token(EndOfLine, (47,14)->(47,14)),
                                                            },
                                                        ),
                                                    ),
                                                ],
                                            },
                                            elseifs: [],
                                            else_command: None,
                                            endif_tok: Token(Identifier, (48,4)->(48,9)),
                                            endif_eol: Token(EndOfLine, (48,9)->(48,9)),
                                        },
                                    ),
                                ],
                            },
                            elseifs: [],
                            else_command: Some(
                                ElseCommand {
                                    else_tok: Token(Identifier, (49,2)->(49,6)),
                                    else_eol: Token(EndOfLine, (49,6)->(49,6)),
                                    body: Body {
                                        commands: [
                                            Statement(
                                                Assign(
                                                    AssignStatement {
                                                        left: Identifier(
                                                            Raw(pat),
                                                        ),
                                                        equals: Token(Equal, (50,8)->(50,9)),
                                                        right: Identifier(
                                                            Raw(searchpat),
                                                        ),
                                                        eol: Token(EndOfLine, (50,19)->(50,19)),
                                                    },
                                                ),
                                            ),
                                        ],
                                    },
                                },
                            ),
                            endif_tok: Token(Identifier, (51,2)->(51,7)),
                            endif_eol: Token(EndOfLine, (51,7)->(51,7)),
                        },
                    ),
                    NoOp(
                        Token(EndOfLine, "\n", (52,0)->(52,0)),
                    ),
                    If(
                        IfCommand {
                            if_tok: Token(Identifier, (53,2)->(53,4)),
                            condition: Infix(
                                InfixExpression {
                                    token: Token(EqualTo, "==", (53,9)->(53,11)),
                                    operator: EqualTo,
                                    left: Identifier(
                                        Raw(pat),
                                    ),
                                    right: String(
                                        SingleQuote(
                                            "",
                                        ),
                                    ),
                                },
                            ),
                            if_eol: Token(EndOfLine, (53,14)->(53,14)),
                            body: Body {
                                commands: [
                                    Return(
                                        ReturnCommand {
                                            ret: Token(Identifier, (54,4)->(54,10)),
                                            expr: None,
                                            eol: Token(EndOfLine, (54,10)->(54,10)),
                                        },
                                    ),
                                ],
                            },
                            elseifs: [],
                            else_command: None,
                            endif_tok: Token(Identifier, (55,2)->(55,7)),
                            endif_eol: Token(EndOfLine, (55,7)->(55,7)),
                        },
                    ),
                    NoOp(
                        Token(EndOfLine, "\n", (56,0)->(56,0)),
                    ),
                    If(
                        IfCommand {
                            if_tok: Token(Identifier, (57,2)->(57,4)),
                            condition: Infix(
                                InfixExpression {
                                    token: Token(EqualTo, "==", (57,10)->(57,12)),
                                    operator: EqualTo,
                                    left: Identifier(
                                        Raw(bang),
                                    ),
                                    right: String(
                                        SingleQuote(
                                            "!",
                                        ),
                                    ),
                                },
                            ),
                            if_eol: Token(EndOfLine, (57,16)->(57,16)),
                            body: Body {
                                commands: [
                                    Statement(
                                        Assign(
                                            AssignStatement {
                                                left: Identifier(
                                                    Raw(Cond),
                                                ),
                                                equals: Token(Equal, (58,9)->(58,10)),
                                                right: Lambda(
                                                    Lambda {
                                                        args: Signature {
                                                            open: Token(LeftParen, (58,11)->(58,12)),
                                                            params: [
                                                                Parameter {
                                                                    name: Raw(_),
                                                                    ty: None,
                                                                    equal: None,
                                                                    default_val: None,
                                                                },
                                                                Parameter {
                                                                    name: Raw(val),
                                                                    ty: None,
                                                                    equal: None,
                                                                    default_val: None,
                                                                },
                                                            ],
                                                            close: Token(RightParen, (58,18)->(58,19)),
                                                        },
                                                        ret: None,
                                                        arrow: Token(Arrow, (58,20)->(58,22)),
                                                        body: Body {
                                                            commands: [
                                                                Return(
                                                                    ReturnCommand {
                                                                        ret: Token(Virtual, (0,0)->(0,0)),
                                                                        expr: Some(
                                                                            Infix(
                                                                                InfixExpression {
                                                                                    token: Token(And, "&&", (58,40)->(58,42)),
                                                                                    operator: And,
                                                                                    left: Infix(
                                                                                        InfixExpression {
                                                                                            token: Token(NotRegexpMatches, "!~#", (58,32)->(58,35)),
                                                                                            operator: NotRegexpMatches,
                                                                                            left: DictAccess(
                                                                                                DictAccess {
                                                                                                    container: Identifier(
                                                                                                        Raw(val),
                                                                                                    ),
                                                                                                    dot: Token(Dot, (58,26)->(58,27)),
                                                                                                    index: RawIdentifier {
                                                                                                        name: "text",
                                                                                                    },
                                                                                                },
                                                                                            ),
                                                                                            right: Identifier(
                                                                                                Raw(pat),
                                                                                            ),
                                                                                        },
                                                                                    ),
                                                                                    right: Infix(
                                                                                        InfixExpression {
                                                                                            token: Token(NotRegexpMatches, "!~#", (58,62)->(58,65)),
                                                                                            operator: NotRegexpMatches,
                                                                                            left: Call(
                                                                                                f: Identifier(Raw(bufname)) arg: [
                                                                                                    DictAccess(
                                                                                                        DictAccess {
                                                                                                            container: Identifier(
                                                                                                                Raw(val),
                                                                                                            ),
                                                                                                            dot: Token(Dot, (58,54)->(58,55)),
                                                                                                            index: RawIdentifier {
                                                                                                                name: "bufnr",
                                                                                                            },
                                                                                                        },
                                                                                                    ),
                                                                                                ],
                                                                                            ),
                                                                                            right: Identifier(
                                                                                                Raw(pat),
                                                                                            ),
                                                                                        },
                                                                                    ),
                                                                                },
                                                                            ),
                                                                        ),
                                                                        eol: Token(Virtual, (0,0)->(0,0)),
                                                                    },
                                                                ),
                                                            ],
                                                        },
                                                    },
                                                ),
                                                eol: Token(EndOfLine, (58,69)->(58,69)),
                                            },
                                        ),
                                    ),
                                ],
                            },
                            elseifs: [],
                            else_command: Some(
                                ElseCommand {
                                    else_tok: Token(Identifier, (59,2)->(59,6)),
                                    else_eol: Token(EndOfLine, (59,6)->(59,6)),
                                    body: Body {
                                        commands: [
                                            Statement(
                                                Assign(
                                                    AssignStatement {
                                                        left: Identifier(
                                                            Raw(Cond),
                                                        ),
                                                        equals: Token(Equal, (60,9)->(60,10)),
                                                        right: Lambda(
                                                            Lambda {
                                                                args: Signature {
                                                                    open: Token(LeftParen, (60,11)->(60,12)),
                                                                    params: [
                                                                        Parameter {
                                                                            name: Raw(_),
                                                                            ty: None,
                                                                            equal: None,
                                                                            default_val: None,
                                                                        },
                                                                        Parameter {
                                                                            name: Raw(val),
                                                                            ty: None,
                                                                            equal: None,
                                                                            default_val: None,
                                                                        },
                                                                    ],
                                                                    close: Token(RightParen, (60,18)->(60,19)),
                                                                },
                                                                ret: None,
                                                                arrow: Token(Arrow, (60,20)->(60,22)),
                                                                body: Body {
                                                                    commands: [
                                                                        Return(
                                                                            ReturnCommand {
                                                                                ret: Token(Virtual, (0,0)->(0,0)),
                                                                                expr: Some(
                                                                                    Infix(
                                                                                        InfixExpression {
                                                                                            token: Token(Or, "||", (60,40)->(60,42)),
                                                                                            operator: Or,
                                                                                            left: Infix(
                                                                                                InfixExpression {
                                                                                                    token: Token(RegexpMatches, "=~#", (60,32)->(60,35)),
                                                                                                    operator: RegexpMatches,
                                                                                                    left: DictAccess(
                                                                                                        DictAccess {
                                                                                                            container: Identifier(
                                                                                                                Raw(val),
                                                                                                            ),
                                                                                                            dot: Token(Dot, (60,26)->(60,27)),
                                                                                                            index: RawIdentifier {
                                                                                                                name: "text",
                                                                                                            },
                                                                                                        },
                                                                                                    ),
                                                                                                    right: Identifier(
                                                                                                        Raw(pat),
                                                                                                    ),
                                                                                                },
                                                                                            ),
                                                                                            right: Infix(
                                                                                                InfixExpression {
                                                                                                    token: Token(RegexpMatches, "=~#", (60,62)->(60,65)),
                                                                                                    operator: RegexpMatches,
                                                                                                    left: Call(
                                                                                                        f: Identifier(Raw(bufname)) arg: [
                                                                                                            DictAccess(
                                                                                                                DictAccess {
                                                                                                                    container: Identifier(
                                                                                                                        Raw(val),
                                                                                                                    ),
                                                                                                                    dot: Token(Dot, (60,54)->(60,55)),
                                                                                                                    index: RawIdentifier {
                                                                                                                        name: "bufnr",
                                                                                                                    },
                                                                                                                },
                                                                                                            ),
                                                                                                        ],
                                                                                                    ),
                                                                                                    right: Identifier(
                                                                                                        Raw(pat),
                                                                                                    ),
                                                                                                },
                                                                                            ),
                                                                                        },
                                                                                    ),
                                                                                ),
                                                                                eol: Token(Virtual, (0,0)->(0,0)),
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            },
                                                        ),
                                                        eol: Token(EndOfLine, (60,69)->(60,69)),
                                                    },
                                                ),
                                            ),
                                        ],
                                    },
                                },
                            ),
                            endif_tok: Token(Identifier, (61,2)->(61,7)),
                            endif_eol: Token(EndOfLine, (61,7)->(61,7)),
                        },
                    ),
                    NoOp(
                        Token(EndOfLine, "\n", (62,0)->(62,0)),
                    ),
                    Statement(
                        Assign(
                            AssignStatement {
                                left: Identifier(
                                    Raw(items),
                                ),
                                equals: Token(Equal, (63,8)->(63,9)),
                                right: Call(
                                    f: Identifier(Raw(filter)) arg: [
                                        Call(
                                            f: Identifier(Raw(Xgetlist)) arg: [],
                                        ),
                                        Identifier(
                                            Raw(Cond),
                                        ),
                                    ],
                                ),
                                eol: Token(EndOfLine, (63,34)->(63,34)),
                            },
                        ),
                    ),
                    Statement(
                        Assign(
                            AssignStatement {
                                left: Identifier(
                                    Raw(title),
                                ),
                                equals: Token(Equal, (64,8)->(64,9)),
                                right: Infix(
                                    InfixExpression {
                                        token: Token(StringConcat, "..", (64,29)->(64,31)),
                                        operator: StringConcat,
                                        left: Infix(
                                            InfixExpression {
                                                token: Token(StringConcat, "..", (64,22)->(64,24)),
                                                operator: StringConcat,
                                                left: Infix(
                                                    InfixExpression {
                                                        token: Token(StringConcat, "..", (64,14)->(64,16)),
                                                        operator: StringConcat,
                                                        left: Identifier(
                                                            Raw(cmd),
                                                        ),
                                                        right: String(
                                                            SingleQuote(
                                                                " /",
                                                            ),
                                                        ),
                                                    },
                                                ),
                                                right: Identifier(
                                                    Raw(pat),
                                                ),
                                            },
                                        ),
                                        right: String(
                                            SingleQuote(
                                                "/",
                                            ),
                                        ),
                                    },
                                ),
                                eol: Token(EndOfLine, (64,35)->(64,35)),
                            },
                        ),
                    ),
                    Eval(
                        EvalCommand {
                            eval: None,
                            expr: Call(
                                f: Identifier(Raw(Xsetlist)) arg: [
                                    Array(
                                        ArrayLiteral {
                                            open: Token(LeftBracket, (65,11)->(65,12)),
                                            elements: [],
                                            close: Token(RightBracket, (65,12)->(65,13)),
                                        },
                                    ),
                                    String(
                                        SingleQuote(
                                            " ",
                                        ),
                                    ),
                                    Dict(
                                        DictLiteral {
                                            open: Token(LeftBrace, (65,20)->(65,21)),
                                            elements: [
                                                KeyValue {
                                                    key: Literal(
                                                        Literal {
                                                            token: Token(Identifier, "title", (65,21)->(65,26)),
                                                        },
                                                    ),
                                                    colon: Token(SpacedColon, (65,26)->(65,28)),
                                                    value: Identifier(
                                                        Raw(title),
                                                    ),
                                                },
                                                KeyValue {
                                                    key: Literal(
                                                        Literal {
                                                            token: Token(Identifier, "items", (65,35)->(65,40)),
                                                        },
                                                    ),
                                                    colon: Token(SpacedColon, (65,40)->(65,42)),
                                                    value: Identifier(
                                                        Raw(items),
                                                    ),
                                                },
                                            ],
                                            close: Token(RightBrace, (65,47)->(65,48)),
                                        },
                                    ),
                                ],
                            ),
                            eol: Token(EndOfLine, (65,49)->(65,49)),
                        },
                    ),
                ],
            },
            enddef: Token(Identifier, (66,0)->(66,6)),
            end_eol: Token(EndOfLine, (66,6)->(66,6)),
        },
    ),
    NoOp(
        Token(EndOfLine, "\n", (67,0)->(67,0)),
    ),
    UserCommand(
        UserCommand {
            tok: Token(Identifier, (68,0)->(68,7)),
            bang: true,
            command_bang: true,
            command_bar: false,
            command_keepscript: false,
            command_register: None,
            command_nargs: Some(
                "+",
            ),
            command_compl: None,
            command_range: None,
            command_addr: None,
            command_complete: None,
            name: "Cfilter",
            command: Eval(
                EvalCommand {
                    eval: None,
                    expr: Call(
                        f: Identifier(Raw(Qf_filter)) arg: [
                            Boolean(
                                VimBoolean {
                                    value: true,
                                },
                            ),
                            Expandable(
                                Expandable {
                                    left: Token(AngleLeft, (68,48)->(68,49)),
                                    ident: Raw(q-args),
                                    right: Token(AngleRight, (68,55)->(68,56)),
                                },
                            ),
                            Expandable(
                                Expandable {
                                    left: Token(AngleLeft, (68,58)->(68,59)),
                                    ident: Raw(q-bang),
                                    right: Token(AngleRight, (68,65)->(68,66)),
                                },
                            ),
                        ],
                    ),
                    eol: Token(EndOfLine, (68,67)->(68,67)),
                },
            ),
        },
    ),
    UserCommand(
        UserCommand {
            tok: Token(Identifier, (69,0)->(69,7)),
            bang: true,
            command_bang: true,
            command_bar: false,
            command_keepscript: false,
            command_register: None,
            command_nargs: Some(
                "+",
            ),
            command_compl: None,
            command_range: None,
            command_addr: None,
            command_complete: None,
            name: "Lfilter",
            command: Eval(
                EvalCommand {
                    eval: None,
                    expr: Call(
                        f: Identifier(Raw(Qf_filter)) arg: [
                            Boolean(
                                VimBoolean {
                                    value: false,
                                },
                            ),
                            Expandable(
                                Expandable {
                                    left: Token(AngleLeft, (69,49)->(69,50)),
                                    ident: Raw(q-args),
                                    right: Token(AngleRight, (69,56)->(69,57)),
                                },
                            ),
                            Expandable(
                                Expandable {
                                    left: Token(AngleLeft, (69,59)->(69,60)),
                                    ident: Raw(q-bang),
                                    right: Token(AngleRight, (69,66)->(69,67)),
                                },
                            ),
                        ],
                    ),
                    eol: Token(EndOfLine, (69,68)->(69,68)),
                },
            ),
        },
    ),
    NoOp(
        Token(EndOfLine, "\n", (70,0)->(70,0)),
    ),
    Comment(
        Token(Comment, "# vim: shiftwidth=2 sts=2 expandtab", (71,0)->(71,35)),
    ),
]
